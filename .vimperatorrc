" Options: ======================================================== {{{1
" exモード時の補完候補がTabキーを押さなくても自動的に表示されて、キー入力するたびに更新される
set wildoptions=auto
" AwesomeBarの補完候補をopenやtabopenの時に使う事が出来る
set complete=sl
" クイックヒントモードでMigemoを使えるようにする。
set hintmatching=custom
" GUI関係の表示（メニュー/ツール/リンク）
" set guioptions=mTb
set guioptions=b
" ビープ音を鳴らさずビジュアルベルを使用
set visualbell
" ビジュアルベルを無効化
set visualbellstyle=display:none;
" ヒストリー回数
set history=1000

" Google Suggest
"set complete=bshf
"set complete+=g

" onload時の自動フォーカスを取りやめる。
set focuscontent

" Mapping: ======================================================== {{{1
" タブの移動
noremap h <C-p>
noremap l <C-n>
noremap j 5<C-e>
noremap k 5<C-y>
noremap gh g0
noremap gl g$

"" 設定ファイルの再読み込み
noremap ,s :so .vimperatorrc<CR>
noremap ,S :mapc<CR>:cmapc<CR>:imapc<CR>:so .vimperatorrc<CR>

" bookmarkコメントを表示
noremap ,c :viewSBMComments -t h<cr>

" URLショートカット
noremap gG <esc>:t http://www.google.co.jp/webhp?hl=ja&complete=1<cr>
noremap gY <esc>:t http://www.yahoo.co.jp/<cr>
noremap gB <esc>:t chrome://livedoorclip_incsearch/content/view.html<cr>
noremap gR <esc>:t http://reader.livedoor.com/reader/<cr>

" Mac標準のキーを使えるように
noremap  <M-c> <C-v><M-c>
inoremap <M-a> <C-v><M-a>
inoremap <M-z> <C-v><M-z>
inoremap <M-x> <C-v><M-x>
inoremap <M-c> <C-v><M-c>
inoremap <M-v> <C-v><M-v>
cnoremap <M-a> <C-v><M-a>
cnoremap <M-z> <C-v><M-z>
cnoremap <M-x> <C-v><M-x>
cnoremap <M-c> <C-v><M-c>
cnoremap <M-v> <C-v><M-v>

" Windows標準のキーを使えるように
noremap  <C-c> <C-v><C-c>
inoremap <C-a> <C-v><C-a>
inoremap <C-z> <C-v><C-z>
inoremap <C-x> <C-v><C-x>
inoremap <C-c> <C-v><C-c>
inoremap <C-v> <C-v><C-v>
cnoremap <C-a> <C-v><C-a>
cnoremap <C-z> <C-v><C-z>
cnoremap <C-x> <C-v><C-x>
cnoremap <C-c> <C-v><C-c>
cnoremap <C-v> <C-v><C-v>

" splitBrowser.js
noremap wc <C-w>c
noremap w0 <C-w>0
noremap w$ <C-w>$
noremap wac :only<CR>
noremap ws :split<CR>
noremap wv :vsplit<CR>
noremap wml :split -l<CR>
noremap wmr :split -r<CR>
noremap wmt :split -t<CR>
noremap wmb :split -b<CR>
noremap wj :split -b<CR>
noremap wk :split -t<CR>
noremap wl :split -r<CR>
noremap wh :split -l<CR>

" MacでCtrl+[でESC 
" Bug 432951の為使用できず
" http://developer.mozilla.org/ja/Gecko_Keypress_Event
" noremap  <Ctrl-[> <esc>
" inoremap  <Ctrl-[> <esc>
" cnoremap  <Ctrl-[> <esc>

" Plugins ========================================================={{{1

" direct_bookmark.js
let g:direct_sbm_use_services_by_tag = "l"
let g:direct_sbm_use_services_by_post = "l"
let g:direct_sbm_is_normalize = "false"

" Migemo検索の時にvimperatorをOFFにする {{{2
javascript <<EOF
vimperator.mappings.add(new Map(vimperator.modes.NORMAL,
	['\\'],\
	function() {
		vimperator.addMode(null,vimperator.modes.ESCAPE_ALL_KEYS);
		var orgFunc = XMigemoUI.timerCallback;
		XMigemoUI.timerCallback = function(aThis){
			orgFunc(aThis);
			vimperator.events.onEscape();
			XMigemoUI.timerCallback = orgFunc;
		}
		XMigemoUI.start();
  },{
    shortHelp: 'Start Migemo/XUL',
    help: 'Start Migemo/XUL'
  }
));
EOF

" 選択時の<C-c>を制御 {{{2
vimperator.mappings.add(new vimperator.Map(
    [vimperator.modes.NORMAL,vimperator.modes.VISUAL],
    ['<C-c>'],
    function() {
        var sel = window.content.document.getSelection();
        if (sel) {
            vimperator.copyToClipboard(sel, true);
        } else {
            BrowserStop();
            vimperator.echo('Stopped loading !');
        }
    },{
        shortHelp: 'Copy selected text or ',
        help: 'The currently selected text is copied to the system clipboard.<br/>' +
              'If selected text is none, stops loading the current web page.'
    }
));

" autoIgnoreKey.jsの設定 {{{2
javascript <<EOM
liberator.globalVariables.autoignorekey_pages = uneval([
  /^https?:\/\/mail\.google\.com\//,
  /^https?:\/\/fastladder\.com\//,
  /^https?:\/\/reader\.livedoor\.com\/reader/,
]);
EOM

" lookupDictionary.jsの設定 {{{2
javascript <<EOM
var dictionalyList = [
    {
        names: ['eiji[ro]'],
        url: 'http://eow.alc.co.jp/%s/UTF-8/',
        shortHelp: '英辞郎',
        xpath: '//*[@id="resultList"]'
    },{
        names: ['goo'],
        url: 'http://dictionary.goo.ne.jp/search.php?MT=%s&kind=all&mode=0',
        shortHelp: 'goo辞書',
        encode: 'EUC-JP',
        xpath: '//div[@id="incontents"]/*[@class="ch04" or @class="fs14" or contains(@class,"diclst")]',
        multi: true
    }
];
EOM

" wildoption=auto で余計なmap対策 {{{2
" http://unsigned.g.hatena.ne.jp/Trapezoid/20080620/1213961754
javascript <<EOM
[
    ['<C-r>',':restart'],
    ['<C-h>',':tabmove! -1'],
    ['<C-l>',':tabmove! +1'],
    ['!',':set invum'],
    ['b',':viewSBMComments'],
    ['B',':bentry'],
    ['a',':sbm'],
    [',a',':btags'],
    ['q',':toggleldrc'],
    ['M',':qmarks'],
].forEach(function([key,command]){
    liberator.mappings.addUserMap([liberator.modes.NORMAL], [key],
        "User defined mapping",
        function () { liberator.execute(command); },
        {
            rhs: key,
            noremap: true
        });
});
EOM

" Etc: ============================================================ {{{1

" }}}1
"source! ~/.vimperatorrc
" vim: set ft=vimperator:
